# 各ディレクトリの役割

## background
- 常駐的に、またはイベントによって動くスクリプトを書くところ。
- 拡張機能でアクセス可能なブラウザの機能をフルで使うことができる。

## content_script
- アクセスしたページの DOM にアクセスして、UI を変えたりできる。

# やりたいこと
## 概要
gitlab の Issue 詳細画面からトラッキングの操作をする

## 仕様
- gitrack のアイコンをクリックすると Popup が開く
  - ✅トラッキングスタートボタンの配置
  - ✅clockify token をオプションから入れられるようにする
  - ✅gitlab の issue 詳細かどうかを、タブを監視して URL のパターンから判定する
  - ✅タスク名初期値は #{Issue 番号} {Issue 名} の形式でインプットに表示する
  - ✅ポジトリ名と一致するプロジェクトがある場合はそれを表示する
  - 無い場合は新規であることが分かるような表示にする
  - 既に計測中であれば時間を表示する（ちょいむずいかも）
  - 過去に計測したデータがあればそのタスクと合計時間を表示する。
- clokify のページに遷移する

# 技術的に実現したいこと
- Popup から local のデータを取得して画面に表示する
- Popup からリロードする
- gitlab の issue 詳細を開いたときに自動で Popup が表示される
- 画面上で常に計測時間が見れるようにする(content_script or icon)

# 次にやること
- ✅同じプロジェクト名が複数あるときにどうするか → 事前に選ばせたい
- ✅プロジェクト一覧にはプロジェクト情報以外の情報（クライアント？）を表示する
- ✅ローディングを入れたい。
- （将来的には）全プロジェクトを表示して、関連性の高そうなものを上に表示する。
- プロジェクトが存在しないときにどうするか → 新規で作る
  - どのような UI にするかは考えたい
- ラベルコンポーネントを作る
- 計測中であれば計測時間やタスク名を表示したい
  - ここまでやってしまうと、clockify の UI をそのまま再実装する必要があるがそれでいいか？

# デバッグメモ
- crm で検索された結果、まったく関係のないプロジェクトもヒットしてバグっていたっぽい。
- 単純な名前検索以外で取得する方法が必要。
  - タブ名
  - hidden な input から取得する方法
  - namespace オプションを ON にしてパス全体で検索する
  - membership オプションを ON にして自分が所属している物だけをだす → 似たような名前だと複数ヒットする。beluga とか。完全一致したプロジェクトの ID を取得する？